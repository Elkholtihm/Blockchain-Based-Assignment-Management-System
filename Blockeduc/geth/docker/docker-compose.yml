services:
  # Node 1 - Sealer (Teacher/Professor)
  geth-node1:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: geth-node1
    hostname: geth-node1
    environment:
      - P2P_PORT=30303
      - IS_SEALER=true
    ports:
      - "8545:8545"
      - "8546:8546"
      - "30303:30303"
    volumes:
      - node1-data:/root/data
    networks:
      blockchain-net:
        ipv4_address: 172.25.0.10
    restart: unless-stopped

  # Node 2 - Observer (Student 1)
  geth-node2:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: geth-node2
    hostname: geth-node2
    environment:
      - P2P_PORT=30303
      - IS_SEALER=false
    ports:
      - "8555:8545"
      - "8556:8546"
      - "30313:30303"
    volumes:
      - node2-data:/root/data
    networks:
      blockchain-net:
        ipv4_address: 172.25.0.11
    depends_on:
      - geth-node1
    restart: unless-stopped

  # Node 3 - Observer (Student 2)
  geth-node3:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: geth-node3
    hostname: geth-node3
    environment:
      - P2P_PORT=30303
      - IS_SEALER=false
    ports:
      - "8565:8545"
      - "8566:8546"
      - "30323:30303"
    volumes:
      - node3-data:/root/data
    networks:
      blockchain-net:
        ipv4_address: 172.25.0.12
    depends_on:
      - geth-node1
    restart: unless-stopped

networks:
  blockchain-net:
    driver: bridge
    ipam:
      config:
        - subnet: 172.25.0.0/16

volumes:
  node1-data:
  node2-data:
  node3-data: